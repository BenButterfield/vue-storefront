<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ElasticSearch Queries | Vue Storefront</title>
    <meta name="description" content="Headless PWA for eCommerce">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.27d3dd69.css" as="style"><link rel="preload" href="/assets/js/app.b420e1be.js" as="script"><link rel="preload" href="/assets/js/8.b6ce1c8b.js" as="script"><link rel="prefetch" href="/assets/js/10.6f0c6bff.js"><link rel="prefetch" href="/assets/js/11.e1617800.js"><link rel="prefetch" href="/assets/js/12.c810605e.js"><link rel="prefetch" href="/assets/js/13.ed623ecf.js"><link rel="prefetch" href="/assets/js/14.b5ce18ff.js"><link rel="prefetch" href="/assets/js/15.94266668.js"><link rel="prefetch" href="/assets/js/16.580969d3.js"><link rel="prefetch" href="/assets/js/17.ed7b6034.js"><link rel="prefetch" href="/assets/js/18.028b3e51.js"><link rel="prefetch" href="/assets/js/19.b416e734.js"><link rel="prefetch" href="/assets/js/2.8772c7e3.js"><link rel="prefetch" href="/assets/js/20.49b833a0.js"><link rel="prefetch" href="/assets/js/21.ef6e38b2.js"><link rel="prefetch" href="/assets/js/22.5a24a8ae.js"><link rel="prefetch" href="/assets/js/23.3c65f413.js"><link rel="prefetch" href="/assets/js/24.68e476c3.js"><link rel="prefetch" href="/assets/js/25.3f879da1.js"><link rel="prefetch" href="/assets/js/26.4ad110d9.js"><link rel="prefetch" href="/assets/js/27.303ace21.js"><link rel="prefetch" href="/assets/js/28.ec22d5d8.js"><link rel="prefetch" href="/assets/js/29.70b80156.js"><link rel="prefetch" href="/assets/js/3.bdf999ff.js"><link rel="prefetch" href="/assets/js/30.b4d929be.js"><link rel="prefetch" href="/assets/js/31.d86a4120.js"><link rel="prefetch" href="/assets/js/32.4dfc68d1.js"><link rel="prefetch" href="/assets/js/33.9e1442e2.js"><link rel="prefetch" href="/assets/js/34.887cc955.js"><link rel="prefetch" href="/assets/js/35.8732dcf7.js"><link rel="prefetch" href="/assets/js/36.bd3e8190.js"><link rel="prefetch" href="/assets/js/37.e254ca81.js"><link rel="prefetch" href="/assets/js/38.fe075a9b.js"><link rel="prefetch" href="/assets/js/39.60f13baa.js"><link rel="prefetch" href="/assets/js/4.76df5465.js"><link rel="prefetch" href="/assets/js/40.3f6f04db.js"><link rel="prefetch" href="/assets/js/41.0dab4356.js"><link rel="prefetch" href="/assets/js/42.34242c28.js"><link rel="prefetch" href="/assets/js/43.f35acd53.js"><link rel="prefetch" href="/assets/js/44.c74c93ea.js"><link rel="prefetch" href="/assets/js/45.11de5b49.js"><link rel="prefetch" href="/assets/js/46.d60e5223.js"><link rel="prefetch" href="/assets/js/47.9e6cc0b4.js"><link rel="prefetch" href="/assets/js/48.7267c1c6.js"><link rel="prefetch" href="/assets/js/49.8d177f81.js"><link rel="prefetch" href="/assets/js/5.e39593d2.js"><link rel="prefetch" href="/assets/js/50.a719c920.js"><link rel="prefetch" href="/assets/js/51.9990985e.js"><link rel="prefetch" href="/assets/js/52.fcf6be99.js"><link rel="prefetch" href="/assets/js/53.8ff2f057.js"><link rel="prefetch" href="/assets/js/54.1ad3b3c1.js"><link rel="prefetch" href="/assets/js/55.cd0bd18f.js"><link rel="prefetch" href="/assets/js/56.04386cda.js"><link rel="prefetch" href="/assets/js/57.6b7e9d6b.js"><link rel="prefetch" href="/assets/js/58.c9ffd6fd.js"><link rel="prefetch" href="/assets/js/59.0c35c80d.js"><link rel="prefetch" href="/assets/js/6.b6f05139.js"><link rel="prefetch" href="/assets/js/60.d386e4ae.js"><link rel="prefetch" href="/assets/js/61.a7fe4890.js"><link rel="prefetch" href="/assets/js/62.994fd22f.js"><link rel="prefetch" href="/assets/js/63.7868e70e.js"><link rel="prefetch" href="/assets/js/64.af456e97.js"><link rel="prefetch" href="/assets/js/65.cee38fe2.js"><link rel="prefetch" href="/assets/js/66.1dd54852.js"><link rel="prefetch" href="/assets/js/67.208afc10.js"><link rel="prefetch" href="/assets/js/68.776e50af.js"><link rel="prefetch" href="/assets/js/7.4ab86a73.js"><link rel="prefetch" href="/assets/js/9.fdc88338.js">
    <link rel="stylesheet" href="/assets/css/0.styles.27d3dd69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Vue Storefront</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.youtube.com/channel/UCkm1F3Cglty3CE1QwKQUhhg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://medium.com/the-vue-storefront-journal" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.youtube.com/channel/UCkm1F3Cglty3CE1QwKQUhhg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://medium.com/the-vue-storefront-journal" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/DivanteLtd/vue-storefront" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/guide/" class="sidebar-link">Introduction to Vue Storefront</a></li><li><a href="/guide/upgrade-notes/" class="sidebar-link">Upgrade notes</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Installation</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/installation/linux-mac.html" class="sidebar-link">Installing on Linux/MacOS</a></li><li><a href="/guide/installation/windows.html" class="sidebar-link">Installing on Windows</a></li><li><a href="/guide/installation/magento.html" class="sidebar-link">Integration with Magento 2</a></li><li><a href="/guide/installation/production-setup.html" class="sidebar-link">Production setup</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Basics</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/basics/project-structure.html" class="sidebar-link">Project structure</a></li><li><a href="/guide/basics/configuration.html" class="sidebar-link">Configuration file explained</a></li><li><a href="/guide/basics/contributing.html" class="sidebar-link">How to Contribute</a></li><li><a href="/guide/basics/feature-list.html" class="sidebar-link">Feature list</a></li><li><a href="/guide/basics/recipes.html" class="sidebar-link">FAQ and Recipes</a></li><li><a href="/guide/basics/typescript.html" class="sidebar-link">TypeScript Action Plan</a></li><li><a href="/guide/basics/graphql.html" class="sidebar-link">GraphQL Action Plan</a></li><li><a href="/guide/basics/ssr-cache.html" class="sidebar-link">SSR Cache</a></li><li><a href="/guide/basics/amp.html" class="sidebar-link">Google Accelerated Mobile Pages</a></li><li><a href="/guide/basics/e2e.html" class="sidebar-link">E2E tests</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Core and themes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/core-themes/themes.html" class="sidebar-link">Themes in Vue Storefront</a></li><li><a href="/guide/core-themes/layouts.html" class="sidebar-link">Layouts and advanced output operations</a></li><li><a href="/guide/core-themes/core-components.html" class="sidebar-link">Working with core components</a></li><li><a href="/guide/core-themes/ui-store.html" class="sidebar-link">Working with UI Store (Interface state)</a></li><li><a href="/guide/core-themes/translations.html" class="sidebar-link">Internationalization (i18n) of Vue Storefront</a></li><li><a href="/guide/core-themes/service-workers.html" class="sidebar-link">Working with Service Workers</a></li><li><a href="/guide/core-themes/webpack.html" class="sidebar-link">Working with Webpack</a></li><li><a href="/guide/core-themes/plugins.html" class="sidebar-link">Working with plugins</a></li><li><a href="/guide/core-themes/stylesheets.html" class="sidebar-link">Working with stylesheets in 'default' theme</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Components</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/components/home-page.html" class="sidebar-link">Core Home Page</a></li><li><a href="/guide/components/category-page.html" class="sidebar-link">Core Category Page</a></li><li><a href="/guide/components/product.html" class="sidebar-link">Core Product Page</a></li><li><a href="/guide/components/modal.html" class="sidebar-link">Modal component</a></li><li><a href="/guide/components/events-list.html" class="sidebar-link">Events List</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Data in Vue Storefront</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/data/data.html" class="sidebar-link">Working with data</a></li><li><a href="/guide/data/elasticsearch.html" class="sidebar-link">ElasticSearch data formats</a></li><li><a href="/guide/data/data-migrations.html" class="sidebar-link">Data Migrations for ElacticSearch</a></li><li><a href="/guide/data/elastic-queries.html" class="active sidebar-link">ElasticSearch Queries</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/data/elastic-queries.html#getting-data-from-elasticsearch" class="sidebar-link">Getting data from ElasticSearch</a></li></ul></li><li><a href="/guide/data/database-tool.html" class="sidebar-link">Database tool</a></li><li><a href="/guide/data/entity-types.html" class="sidebar-link">Data Entity Types</a></li><li><a href="/guide/data/static-data.html" class="sidebar-link">Static Data support in Vue Storefront</a></li><li><a href="/guide/data/data-loader.html" class="sidebar-link">Async Data Loader</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Extensions</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/extensions/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/extensions/extending-api.html" class="sidebar-link">Extending the API</a></li><li><a href="/guide/extensions/extending-server-side-routes.html" class="sidebar-link">Extending Express.js server side routes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Working with Vuex</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/vuex/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/vuex/vuex-conventions.html" class="sidebar-link">Vuex conventions</a></li><li><a href="/guide/vuex/product-store.html" class="sidebar-link">Product Vuex Store</a></li><li><a href="/guide/vuex/category-store.html" class="sidebar-link">Category Vuex Store</a></li><li><a href="/guide/vuex/stock-store.html" class="sidebar-link">Stock Vuex Store</a></li><li><a href="/guide/vuex/attribute-store.html" class="sidebar-link">Attribute Vuex Store</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Modules</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/modules/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/modules/cart.html" class="sidebar-link">Cart module</a></li><li><a href="/guide/modules/user.html" class="sidebar-link">User Module</a></li><li><a href="/guide/modules/checkout.html" class="sidebar-link">Checkout Module</a></li><li><a href="/guide/modules/order.html" class="sidebar-link">Order module</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Integrations</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/guide/integrations/integrations.html" class="sidebar-link">Existing integrations</a></li><li><a href="/guide/integrations/reviews.html" class="sidebar-link">Product Reviews</a></li><li><a href="/guide/integrations/payment-gateway.html" class="sidebar-link">Payment Gateway Integration</a></li><li><a href="/guide/integrations/paypal-payments.html" class="sidebar-link">PayPal payments support</a></li><li><a href="/guide/integrations/direct-prices-sync.html" class="sidebar-link">Direct prices sync with Magento</a></li><li><a href="/guide/integrations/tier-prices-sync.html" class="sidebar-link">Tier prices sync with Magento</a></li><li><a href="/guide/integrations/totals-sync.html" class="sidebar-link">Totals and cart sync with Magento</a></li><li><a href="/guide/integrations/multistore.html" class="sidebar-link">Multistore Magento2 support</a></li><li><a href="/guide/integrations/product-reviews.html" class="sidebar-link">Product Reviews</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="elasticsearch-queries"><a href="#elasticsearch-queries" aria-hidden="true" class="header-anchor">#</a> ElasticSearch Queries</h1> <h2 id="getting-data-from-elasticsearch"><a href="#getting-data-from-elasticsearch" aria-hidden="true" class="header-anchor">#</a> Getting data from ElasticSearch</h2> <p>VueStorefront stores most of the catalog data within the ElasticSearch data store. Please have a look at our architecture diagram:</p> <p><img src="/assets/img/Vue-storefront-architecture.c0baad07.png" alt="Architecture diagram">.</p> <p>To properly access ElasticSearch data, you should implement a specific Vuex action. Here is an example of <a href="https://github.com/DivanteLtd/vue-storefront/blob/c954b96f6633a201e10bed1d2e4c0def1aeb3071/core/store/modules/category.js#L38" target="_blank" rel="noopener noreferrer">vuex action for getting the data<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> quickSearchByQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../lib/search'</span>

  <span class="token comment">/**
   * Load categories within specified parent
   * @param {Object} commit promise
   * @param {Object} parent parent category
   */</span>
  <span class="token function">list</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token punctuation">{</span> parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> onlyActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> onlyNotEmpty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">4000</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sort <span class="token operator">=</span> <span class="token string">'position:asc'</span><span class="token punctuation">,</span> includeFields <span class="token operator">=</span> config<span class="token punctuation">.</span>entities<span class="token punctuation">.</span>optimize <span class="token operator">?</span> config<span class="token punctuation">.</span>entities<span class="token punctuation">.</span>category<span class="token punctuation">.</span>includeFields <span class="token punctuation">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> commit <span class="token operator">=</span> context<span class="token punctuation">.</span>commit

    <span class="token keyword">let</span> searchQuery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> parent <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      searchQuery <span class="token operator">=</span> searchQuery<span class="token punctuation">.</span><span class="token function">applyFilter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>key<span class="token punctuation">:</span> <span class="token string">'parent_id'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'eq'</span><span class="token punctuation">:</span> parent<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>onlyActive <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      searchQuery <span class="token operator">=</span> searchQuery<span class="token punctuation">.</span><span class="token function">applyFilter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>key<span class="token punctuation">:</span> <span class="token string">'is_active'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'eq'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>onlyNotEmpty <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      searchQuery <span class="token operator">=</span> searchQuery<span class="token punctuation">.</span><span class="token function">applyFilter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>key<span class="token punctuation">:</span> <span class="token string">'product_count'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'gt'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>context<span class="token punctuation">.</span>state<span class="token punctuation">.</span>list <span class="token operator">|</span> context<span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">quickSearchByQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> entityType<span class="token punctuation">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span> searchQuery<span class="token punctuation">,</span> sort<span class="token punctuation">:</span> sort<span class="token punctuation">,</span> size<span class="token punctuation">:</span> size<span class="token punctuation">,</span> start<span class="token punctuation">:</span> start<span class="token punctuation">,</span> includeFields<span class="token punctuation">:</span> includeFields <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">CATEGORY_UPD_CATEGORIES</span><span class="token punctuation">,</span> resp<span class="token punctuation">)</span>
        EventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'category-after-list'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> query<span class="token punctuation">:</span> searchQuery<span class="token punctuation">,</span> sort<span class="token punctuation">:</span> sort<span class="token punctuation">,</span> size<span class="token punctuation">:</span> size<span class="token punctuation">,</span> start<span class="token punctuation">:</span> start<span class="token punctuation">,</span> list<span class="token punctuation">:</span> resp <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> resp
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>As You may see we're using <a href="https://github.com/DivanteLtd/vue-storefront/blob/c954b96f6633a201e10bed1d2e4c0def1aeb3071/core/lib/search/search.js#L60" target="_blank" rel="noopener noreferrer">quickSearchByQuery<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for executing Search. This method is pretty interesting because:</p> <ul><li>it uses the <code>searchQuery</code> query object which has an ability to apply filters in common way</li> <li>it does cache the received data into <code>localForage</code> collection named <code>elasticCache</code>; the next call with the same queryObject will return the data directly from the browser storage, not hiting the server.</li></ul> <p>We do not build elasticsearch query on this step more. We use search layer object containing all necessary filters and search text. ES query builds using the powerful bodybuilder package right before sending Elasticsearch request. Please take a look at the <a href="https://github.com/danpaz/bodybuilder" target="_blank" rel="noopener noreferrer">reference docs for more options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/DivanteLtd/vue-storefront/edit/master/docs/guide/data/elastic-queries.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/guide/data/data-migrations.html" class="prev">
          Data Migrations for ElacticSearch
        </a></span> <span class="next"><a href="/guide/data/database-tool.html">
          Database tool
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.b420e1be.js" defer></script><script src="/assets/js/8.b6ce1c8b.js" defer></script>
  </body>
</html>
